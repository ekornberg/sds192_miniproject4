---
title: "SDS 192 Mini Project 4"
author: Vatsala Ramanan, Margaret Bassney, and Emma Kornberg
output: html_document
code_folding: hide
---

```{r message = FALSE, echo = FALSE, warning = FALSE}
library(tidyverse)
library(RMySQL)

db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "imdb")

knitr::opts_chunk$set(connection = db, max.print = 20)
```

#2000
```{sql connection= db, warning = FALSE, message = FALSE, echo = FALSE}
SELECT t.title, t.production_year, mi.info as rating, mi2.info as language,mi3.info AS movie_rating
FROM title t 
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
JOIN movie_info_idx AS mi3 ON mi3.movie_id = t.id
WHERE mi.info_type_id IN (67, 97) 
  AND mi.info LIKE '%PG-13%'
  AND kind_id = 1
  AND mi2.info_type_id = 4
  AND mi3.info_type_id = 101
  AND mi2.info = 'English'
  AND production_year = 2000
ORDER BY movie_rating DESC
LIMIT 0,10;
```

#2004
```{sql connection= db, warning = FALSE, message = FALSE, echo = FALSE}
SELECT t.title, t.production_year, mi.info as rating, mi2.info as language,mi3.info AS movie_rating
FROM title t 
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
JOIN movie_info_idx AS mi3 ON mi3.movie_id = t.id
WHERE mi.info_type_id IN (67, 97) 
  AND mi.info LIKE '%PG-13%'
  AND kind_id = 1
  AND mi2.info_type_id = 4
  AND mi3.info_type_id = 101
  AND mi2.info = 'English'
  AND production_year = 2004
ORDER BY movie_rating DESC
LIMIT 0,10;
```

#2008
```{sql connection= db, warning = FALSE, message = FALSE, echo = FALSE}
SELECT t.title, t.production_year, mi.info as rating, mi2.info as language,mi3.info AS movie_rating
FROM title t 
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
JOIN movie_info_idx AS mi3 ON mi3.movie_id = t.id
WHERE mi.info_type_id IN (67, 97) 
  AND mi.info LIKE '%PG-13%'
  AND kind_id = 1
  AND mi2.info_type_id = 4
  AND mi3.info_type_id = 101
  AND mi2.info = 'English'
  AND production_year = 2008
ORDER BY movie_rating DESC
LIMIT 0,10;
```

#2012
```{sql connection= db, warning = FALSE, message = FALSE, echo = FALSE}
SELECT t.title, t.production_year, mi.info as rating, mi2.info as language,mi3.info AS movie_rating
FROM title t 
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
JOIN movie_info_idx AS mi3 ON mi3.movie_id = t.id
WHERE mi.info_type_id IN (67, 97) 
  AND mi.info LIKE '%PG-13%'
  AND kind_id = 1
  AND mi2.info_type_id = 4
  AND mi3.info_type_id = 101
  AND mi2.info = 'English'
  AND production_year = 2012
ORDER BY movie_rating DESC
LIMIT 0,10;
```

#2017
```{sql connection= db, warning = FALSE, message = FALSE, echo = FALSE}
SELECT t.title, t.production_year, mi.info as rating, mi2.info as language,mi3.info AS movie_rating
FROM title t 
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
JOIN movie_info_idx AS mi3 ON mi3.movie_id = t.id
WHERE mi.info_type_id IN (67, 97) 
  AND mi.info LIKE '%PG-13%'
  AND kind_id = 1
  AND mi2.info_type_id = 4
  AND mi3.info_type_id = 101
  AND mi2.info = 'English'
  AND production_year = 2017
ORDER BY movie_rating DESC
LIMIT 0,10;
```

